require 'spec_helper'
require 'vcr_helper'

RSpec.describe OpenStax::Content::S3, vcr: VCR_OPTS do
  subject(:s3)          { described_class.new }
  let(:archive_path)    { OpenStax::Content.archive_path.chomp('/') }
  let(:archive_version) { MINI_BOOK_ARCHIVE_VERSION }
  let(:book_id)         { "#{MINI_BOOK.uuid}@#{MINI_BOOK.version}" }
  let(:page_uuid)       { MINI_BOOK_PAGE_HASHES[0]['id'] }
  let(:extension)       { 'json' }

  context '#path_for' do
    it 'can return the archive path prefix' do
      expect(s3.path_for).to eq "#{archive_path}/"
    end

    it 'can generate the path prefix for an archive version' do
      expect(s3.path_for archive_version).to eq(
        "#{archive_path}/#{archive_version}/contents/"
      )
    end

    it 'can generate the path prefix for an archive version and book id' do
      expect(s3.path_for archive_version, book_id).to eq(
        "#{archive_path}/#{archive_version}/contents/#{book_id}:"
      )
    end

    it 'can generate the path prefix for an archive version, book id and page uuid' do
      expect(s3.path_for archive_version, book_id, page_uuid).to eq(
        "#{archive_path}/#{archive_version}/contents/#{book_id}:#{page_uuid}."
      )
    end

    it 'can generate the path for an archive version, book id, page uuid and extension' do
      expect(s3.path_for archive_version, book_id, page_uuid, extension).to eq(
        "#{archive_path}/#{archive_version}/contents/#{book_id}:#{page_uuid}.#{extension}"
      )
    end
  end

  context '#ls' do
    it 'can list all archive versions' do
      expect(s3.ls).to eq [
        "20200827.155539",
        "20201014.233724",
        "20201029.133542",
        "20201222.172624",
        "20210224.204120",
        "20210325.214454",
        "20210421.141058",
        "20210514.171726"
      ]
    end

    it 'can list all book ids for a given archive version' do
      expect(s3.ls archive_version).to eq [
        "02040312-72c8-441e-a685-20e9333f3e1d@14.4",
        "02040312-72c8-441e-a685-20e9333f3e1d@14.5",
        "02040312-72c8-441e-a685-20e9333f3e1d@15.10",
        "02040312-72c8-441e-a685-20e9333f3e1d@15.7",
        "02776133-d49d-49cb-bfaa-67c7f61b25a1@14.1",
        "031da8d3-b525-429c-80cf-6c8ed997733a@23.16",
        "031da8d3-b525-429c-80cf-6c8ed997733a@23.18",
        "06aba565-9432-40f6-97ee-b8a361f118a8@4.15",
        "06aba565-9432-40f6-97ee-b8a361f118a8@4.18",
        "0889907c-f0ef-496a-bcb8-2a5bb121717f@9.2",
        "0889907c-f0ef-496a-bcb8-2a5bb121717f@9.3",
        "13ac107a-f15f-49d2-97e8-60ab2e3b519c@31.2",
        "13ac107a-f15f-49d2-97e8-60ab2e3b519c@33.3",
        "14fb4ad7-39a1-4eee-ab6e-3ef2482e3e22@22.7",
        "14fb4ad7-39a1-4eee-ab6e-3ef2482e3e22@22.8",
        "175c88b6-f89b-4eba-9514-bc45e2139a1d@1.2",
        "185cbf87-c72e-48f5-b51e-f14f21b5eabd@14.1",
        "1b4ee0ce-ee89-44fa-a5e7-a0db9f0c94b1@6.1",
        "1b4ee0ce-ee89-44fa-a5e7-a0db9f0c94b1@6.21",
        "1b4ee0ce-ee89-44fa-a5e7-a0db9f0c94b1@6.2",
        "1b4ee0ce-ee89-44fa-a5e7-a0db9f0c94b1@6.3",
        "1d39a348-071f-4537-85b6-c98912458c3c@15.1",
        "1d39a348-071f-4537-85b6-c98912458c3c@22.1",
        "27f59064-990e-48f1-b604-5188b9086c29@15.1",
        "27f59064-990e-48f1-b604-5188b9086c29@16.1",
        "2d941ab9-ac5b-4eb8-b21c-965d36a4f296@9.1",
        "2d941ab9-ac5b-4eb8-b21c-965d36a4f296@9.8",
        "2e737be8-ea65-48c3-aa0a-9f35b4c6a966@22.20",
        "2e737be8-ea65-48c3-aa0a-9f35b4c6a966@22.49",
        "30189442-6998-4686-ac05-ed152b91b9de@25.23",
        "33076054-ec1d-4417-8824-ce354efe42d0@4.2",
        "36004586-651c-4ded-af87-203aca22d946@14.3",
        "394a1101-fd8f-4875-84fa-55f15b06ba66@8.13",
        "394a1101-fd8f-4875-84fa-55f15b06ba66@8.19",
        "405335a3-7cff-4df2-a9ad-29062a4af261@8.46",
        "4061c832-098e-4b3c-a1d9-7eb593a2cb31@13.2",
        "4539ae23-1ccc-421e-9b25-843acbb6c4b0@10.1",
        "464a3fba-68c1-426a-99f9-597e739dc911@8.8",
        "464a3fba-68c1-426a-99f9-597e739dc911@8.9",
        "4664c267-cd62-4a99-8b28-1cb9b3aee347@6.5",
        "4664c267-cd62-4a99-8b28-1cb9b3aee347@7.2",
        "4abf04bf-93a0-45c3-9cbc-2cefd46e68cc@13.2",
        "4e09771f-a8aa-40ce-9063-aa58cc24e77f@9.7",
        "4e09771f-a8aa-40ce-9063-aa58cc24e77f@9.8",
        "507feb1e-cfff-4b54-bc07-d52636cecfe3@10.2",
        "507feb1e-cfff-4b54-bc07-d52636cecfe3@9.12",
        "55931856-c627-418b-a56f-1dd0007683a8@9.3",
        "5bcc0e59-7345-421d-8507-a1e4608685e8@19.1",
        "5c09762c-b540-47d3-9541-dda1f44f16e5@18.1",
        "5c09762c-b540-47d3-9541-dda1f44f16e5@19.1",
        "636cbfd9-4e37-4575-83ab-9dec9029ca4e@14.1",
        "636cbfd9-4e37-4575-83ab-9dec9029ca4e@15.1",
        "69619d2b-68f0-44b0-b074-a9b2bf90b2c6@12.4",
        "6c322e32-9fb0-4c4d-a1d7-20c95c5c7af2@26.26",
        "6c322e32-9fb0-4c4d-a1d7-20c95c5c7af2@26.6",
        "746f171e-0d6a-4ef2-b69d-367880872f4a@1.3",
        "746f171e-0d6a-4ef2-b69d-367880872f4a@3.10",
        "746f171e-0d6a-4ef2-b69d-367880872f4a@3.17",
        "746f171e-0d6a-4ef2-b69d-367880872f4a@3.19",
        "746f171e-0d6a-4ef2-b69d-367880872f4a@3.7",
        "7a0f9770-1c44-4acd-9920-1cd9a99f2a1e@24.2",
        "7a0f9770-1c44-4acd-9920-1cd9a99f2a1e@27.1",
        "7fccc9cf-9b71-44f6-800b-f9457fd64335@18.26",
        "7fccc9cf-9b71-44f6-800b-f9457fd64335@18.36",
        "85abf193-2bd2-4908-8563-90b8a7ac8df6@13.1",
        "8b89d172-2927-466f-8661-01abc7ccdba4@22.1",
        "8b89d172-2927-466f-8661-01abc7ccdba4@22.2",
        "8d04a686-d5e8-4798-a27d-c608e4d0e187@34.4",
        "8d04a686-d5e8-4798-a27d-c608e4d0e187@35.2",
        "8d50a0af-948b-4204-a71d-4826cba765b8@16.174",
        "8d50a0af-948b-4204-a71d-4826cba765b8@16.179",
        "9117cf8c-a8a3-4875-8361-9cb0f1fc9362@14.1",
        "9117cf8c-a8a3-4875-8361-9cb0f1fc9362@15.1",
        "914ac66e-e1ec-486d-8a9c-97b0f7a99774@5.14",
        "920d1c8a-606c-4888-bfd4-d1ee27ce1795@17.5",
        "920d1c8a-606c-4888-bfd4-d1ee27ce1795@18.1",
        "9ab4ba6d-1e48-486d-a2de-38ae1617ca84@7.7",
        "9ab4ba6d-1e48-486d-a2de-38ae1617ca84@7.8",
        "9b08c294-057f-4201-9f48-5d6ad992740d@29.3",
        "9b08c294-057f-4201-9f48-5d6ad992740d@31.1",
        "9b08c294-057f-4201-9f48-5d6ad992740d@32.2",
        "9d8df601-4f12-4ac1-8224-b450bf739e5f@6.5",
        "9d8df601-4f12-4ac1-8224-b450bf739e5f@6.7",
        "a31cd793-2162-4e9e-acb5-6e6bbd76a5fa@15.1",
        "a31cd793-2162-4e9e-acb5-6e6bbd76a5fa@22.1",
        "a7ba2fb8-8925-4987-b182-5f4429d48daa@10.18",
        "a7ba2fb8-8925-4987-b182-5f4429d48daa@10.21",
        "af275420-6050-4707-995c-57b9cc13c358@20.1",
        "af275420-6050-4707-995c-57b9cc13c358@22.5",
        "afe4332a-c97f-4fc4-be27-4e4d384a32d8@18.1",
        "b3c1e1d2-839c-42b0-a314-e119a8aafbdd@17.18",
        "b3c1e1d2-839c-42b0-a314-e119a8aafbdd@17.23",
        "b56bb9e9-5eb8-48ef-9939-88b1b12ce22f@38.22",
        "b56bb9e9-5eb8-48ef-9939-88b1b12ce22f@38.24",
        "bc498e1f-efe9-43a0-8dea-d3569ad09a82@10.7",
        "bc498e1f-efe9-43a0-8dea-d3569ad09a82@12.4",
        "c3acb2ab-7d5c-45ad-b3cd-e59673fedd4e@12.1",
        "c3acb2ab-7d5c-45ad-b3cd-e59673fedd4e@12.8",
        "ca344e2d-6731-43cd-b851-a7b3aa0b37aa@7.1",
        "caa57dab-41c7-455e-bd6f-f443cda5519c@21.1",
        "cce64fde-f448-43b8-ae88-27705cceb0da@14.21",
        "cce64fde-f448-43b8-ae88-27705cceb0da@14.7",
        "d380510e-6145-4625-b19a-4fa68204b6b1@11.1",
        "d380510e-6145-4625-b19a-4fa68204b6b1@12.7",
        "d50f6e32-0fda-46ef-a362-9bd36ca7c97d@21.4",
        "d50f6e32-0fda-46ef-a362-9bd36ca7c97d@22.3",
        "d9b85ee6-c57f-4861-8208-5ddf261e9c5f@14.26",
        "d9b85ee6-c57f-4861-8208-5ddf261e9c5f@14.36",
        "e42bd376-624b-4c0f-972f-e0c57998e765@9.12",
        "e42bd376-624b-4c0f-972f-e0c57998e765@9.13",
        "e8668a14-9a7d-4d74-b58c-3681f8351224@10.1",
        "e8668a14-9a7d-4d74-b58c-3681f8351224@10.2",
        "ea2f225e-6063-41ca-bcd8-36482e15ef65@13.3",
        "f0fa90be-fca8-43c9-9aad-715c0a2cee2b@10.5",
        "f0fa90be-fca8-43c9-9aad-715c0a2cee2b@11.2",
        "fd53eae1-fa23-47c7-bb1b-972349835c3c@36.3"
      ]
    end

    it 'can list all page uuids for a given archive version and book id' do
      expect(s3.ls archive_version, book_id).to eq [
        "0249eeb6-6e12-4b6c-a18e-87cab964ec98",
        "0514294f-a96f-54c3-9dc9-f9b98092c133",
        "0530a45f-426f-4804-b22d-5d72704fa777",
        "05be0e90-f280-42e1-b8f1-eb0ec18c9e90",
        "07086db1-b06b-5dcf-b446-f3b4217f5d04",
        "0765b5ba-b49a-413f-a5a9-fe4ef34e386e",
        "07ee714e-e453-4866-ba35-3f2ec6916a4f",
        "085589bb-9ea4-443a-84c3-72c56f6b265d",
        "087dc807-eaae-5b52-be2a-1dbc4812cc02",
        "088a8848-6bd2-5c2b-81d1-2f0b6853325b",
        "0893943f-9f8b-4fd8-ab21-85dfd7f9ca48",
        "095d316b-cb2f-4ae1-9772-296e74ec3216",
        "0a187066-b005-470a-825f-a423a4a6a6e7",
        "0a64df9f-607a-48ab-aec6-885bd47b1b81",
        "0a8ba6ca-df73-56e1-87ce-ad07994ed989",
        "0a9bec78-55c3-52f9-85a7-cb9942baba08",
        "0a9db352-56cc-40a3-a57c-296990f8ac42",
        "0b5ceb83-9942-4f31-97ea-e86ea0c335d5",
        "0c556e6a-10d0-434a-aa98-a3b2f1e59dc7",
        "0d0ebc3d-b23b-492f-9c2f-bf546e6677d9",
        "0e8d7133-51bc-42a8-a6f3-d066686e650a",
        "0f59bf7f-ccea-41d0-85aa-eaddc271ed44",
        "10094ca7-1854-4ec5-94fb-d7de5fdd18d1",
        "102cdbe5-a5ed-52ae-8dc8-965a7d599db2",
        "10b193c0-c24b-4728-ae7f-897aa25355d8",
        "1265f87b-fe08-4e80-817c-cf5ca9a03a73",
        "126dc167-76ef-41c9-a03f-4c8b1d0ac7cf",
        "131dfbaa-2699-5048-b6ee-cb3c24f70a9e",
        "138c7e30-056c-4c8e-a781-226126ac062e",
        "14a20783-3535-45f0-8df9-413d24882a89",
        "15cabc80-e84c-4250-8f87-778c4aa08f39",
        "1609ec7b-f319-4a25-b6c2-2cb58aff976b",
        "17d932a9-8575-40ac-9448-be8c94c09a48",
        "1858a7b1-aab7-5b75-8ccc-488d8b21875c",
        "18acbfff-6506-592c-945c-1e1bc2cbf91e",
        "18c2a71f-9d66-547f-a5f0-7253362f8823",
        "19167780-b506-5fcb-977f-8746ebd30071",
        "1957734f-0995-487c-835f-646793a721c5",
        "19bdd8fc-1833-40ba-90fd-ca8df2707e6e",
        "19d67739-2243-597a-a159-24f73ed0fcd2",
        "1a3bf6c9-a1a2-4155-b1a7-b86859bc150d",
        "1b79a450-f691-4301-aef3-d065268ab4a9",
        "1ba0e763-9024-4ac0-bae5-c38744b9ab99",
        "1bd61925-45e0-4318-b1db-ab61507bb1e3",
        "1be3afde-a090-4499-a302-f39b3bd402dd",
        "1c26b686-8486-51e7-b992-2a5a35ffac66",
        "1c5971cb-9849-466e-b6f1-5dd7bd3958d6",
        "1c787a8b-a493-56f5-a00c-752996761ba4",
        "1ced24b9-8724-4ca8-8d72-87e7fafa97ae",
        "1d51678e-c392-4a22-91c4-0ea057561cc5",
        "1ddf7960-d3c6-438e-a96e-ce0c5d3efd59",
        "1ece018f-4092-5b5e-84c2-f8ec123a7096",
        "1fc15ec2-692c-5b4e-8cb8-cae09557d896",
        "206e7a16-29d9-4453-b60f-07272a7ffe5d",
        "20ecccca-ce8d-4067-9d78-b1cd34d9b582",
        "21b1ac75-04bc-50fd-ab24-f787a41aca89",
        "2242a8c5-e8b1-4287-b801-af74ef6f1e5b",
        "22f4b2c8-fef3-4376-b312-f150a671c089",
        "22f89152-1868-5819-aade-505eeff462bf",
        "234d2c40-0409-5541-ab34-019187866ff7",
        "249bdb5f-9031-4d3f-b78c-175a61ea026c",
        "24b4a5dc-66b4-5906-a15b-72e93a0bab86",
        "25788393-26c0-49b4-9c1a-1e52bfcbb1b4",
        "25999bf2-d3b4-4763-b10b-86d9e977d218",
        "259cdafc-1531-52a8-b6d2-0fbcbff31b18",
        "262fd20e-cf68-4786-b740-e85d6c88dbe6",
        "26396539-8aea-4808-93ee-181028b36fb2",
        "2682524f-0a3c-51a0-a089-0a7eb3e2a774",
        "268333ac-bace-432d-9e5b-0c8a58bac4b5",
        "26a3d0a5-c3b8-45b9-a763-f0047e12fd7d",
        "27d84293-3838-4477-bff4-3487ba96fa9a",
        "28568cca-f4b9-446d-bca5-ea6a6f768afa",
        "286fc73e-e88e-5b9f-87d5-5c84bb688167",
        "2877ca22-e24d-4b73-a889-554e6b98f8f9",
        "28c27cce-e469-4552-b1d5-1958417de8c7",
        "2931f386-c9d5-5ee2-ae50-c7a5dd82ff98",
        "297670bd-4d80-4d33-be7e-0c51adf40de6",
        "2a2e9be4-4347-436c-a23f-4793524d359e",
        "2aa5132a-ca3e-512c-9596-ba0f42e78eff",
        "2d326b01-dd59-4a66-b00c-ac6f4b760278",
        "2d525c54-fa50-4de3-8271-c0d2fb5fea9c",
        "2e0bed0b-0c49-48ef-bc1b-782106cb211d",
        "2e7a4d00-d38b-4a1e-94ab-a899b90ba960",
        "2ea1d975-df56-4384-b654-2f0ae0ce76a9",
        "2eb0c7dd-906d-55cb-868c-708a2ae0331c",
        "2fe97854-3deb-5d95-abd0-ba9b4762c805",
        "316775f2-8777-474c-b787-e64ea38cb026",
        "326a4dc3-25a7-508e-a0c9-2abe0757bdf6",
        "32b51dcb-a8a8-5a9d-b938-b737bb40a289",
        "336edd2d-e6ba-4e31-bdc5-ee8fe5bd4b26",
        "341670d4-6727-4cc7-8845-68b6a030efa9",
        "35d111b8-4307-56bb-ae3c-c5ed8324793b",
        "3639d684-af97-4ad8-9986-2b91609478bf",
        "36d1e22b-f3b7-4b76-a39d-ef3972cc403e",
        "36f33298-cf65-5ac7-903d-b1906838e4f0",
        "3732ec62-7816-452c-b100-334a28464590",
        "37522359-b0ee-5625-87fc-3a8822533293",
        "38d57204-8d16-57e9-b33a-2ddc7e454faf",
        "3921ce75-f453-433d-84cc-b50dd486c27d",
        "393ade91-3c7c-43d5-9b66-5018ee059ae2",
        "399cb4d1-0f14-44df-8a92-5c0d34ba3d57",
        "3ad5c773-e6eb-5ad1-b7fb-1937f694c3a3",
        "3b3f2d28-d152-51eb-abaa-d7590bcc9643",
        "3b675ba6-99d4-46cf-ad2e-010568d37861",
        "3c025567-c0a7-4298-a9be-290976d1afab",
        "3c4ca45d-a74e-5e55-a2f8-ebd5f78f93df",
        "3cbdb423-0774-41fc-bec3-59c2f1480a86",
        "3d54039b-edf9-4026-811c-eec45df5eb77",
        "3d7f4d9e-6253-5dc1-9bd7-2ef0b34f2976",
        "3f5f35ea-f553-522f-a072-6871353391d1",
        "3fbaab44-ad7b-56fa-a1a3-d3d6c89c089b",
        "3fe723a8-86ee-40f4-afc0-98145fd25ff0",
        "40a49f6e-d9d4-4c32-bc84-a4414f1dbd44",
        "40bcb01b-cd02-4809-b2e2-d11cf3eeb955",
        "40c47b1f-4062-4577-94de-5bc1a6472a11",
        "41fe6750-ff6b-4b88-a869-c2befd1da741",
        "42b1210e-bcd7-436a-bf8d-782a9401fd01",
        "43dd126f-ae39-4d3b-91ce-73c84a8e80d4",
        "44b68507-981c-4dc8-9683-0a65f9b69c2f",
        "45686d1b-cb36-4318-badd-6d4c4425c4e4",
        "456f6590-24fd-44ee-8f97-d4cb7f15a706",
        "46055dad-0e2b-5b5b-aefb-5e9976ecb48d",
        "472ec4a3-8bf8-4d33-9b22-caa9c7e10c6d",
        "476d6890-79d3-4f7d-977c-2cab99257a32",
        "48eb4a92-e1e6-45e5-9f60-c4a3ae79199d",
        "48fe7831-5221-4284-a7d7-af6af0193f30",
        "497c350c-7e8d-5fca-be0a-6efeda84392b",
        "49cb40be-0ee0-5013-8d1c-ccae64deb343",
        "4a23ee42-d035-4048-aa1b-863dd4c31a39",
        "4be236a9-6543-4872-9be5-b839f5e8f698",
        "4c111ec0-8783-4adf-90f0-f4a274e77cc1",
        "4c522663-df2c-5123-a225-3b3d285bb815",
        "4c949cb5-0eee-4ff3-9c7d-0fdc8d78afef",
        "4cfd3c2d-dad1-4133-8dae-0c321a6577a4",
        "4dfbbd6a-f8c3-5d76-9ff3-667ceef61501",
        "4e14dea3-428c-4028-9acf-09950810a2f5",
        "4e970a37-25b1-561a-9a51-05b2959a60ba",
        "4f0a6bf0-beb0-50f3-8fca-ad1ea8a80c28",
        "4f6fd8cb-7a2e-5700-a952-3cfeabd4360a",
        "503da998-00c5-4af7-8f5a-386f08ac6ec9",
        "5110a96f-dced-4c29-af98-a9fc11b69796",
        "5142d98d-6d50-4752-a015-fb0231e5a6de",
        "5173d9d0-cdae-56f8-b36b-7944d5e57843",
        "533d782d-bcde-44b0-8913-a03b6470dae1",
        "53e8a43c-eedf-4b8a-9744-3571a2108561",
        "54f64fe4-c257-409a-88ee-f0de6b51fd72",
        "55778261-2034-4da6-91b9-56362e4a4a9c",
        "5594c299-297d-400d-82ac-54c4158282b5",
        "55c9fd25-c7c5-4d43-a8c1-c75cd40fb8b1",
        "57652f7e-1ad7-4a24-bdb2-d350dee60c29",
        "57d8ebae-5a58-4afa-a317-ce87a0feb787",
        "581db8e9-1a7b-4d58-9748-dc2e3115e0a7",
        "582d97fa-6cb8-5401-ad2a-4ded5d5c9a58",
        "584c9411-06ea-41cc-b4f9-2d3b2873e844",
        "59467866-4818-476c-affa-f56028c78f0c",
        "5a0066ad-604d-48cc-b6c9-b3d06e154d7d",
        "5ab359e7-b922-4b27-b86b-aff3cc82175e",
        "5b60afa4-6b5f-456d-a318-7c86660be306",
        "5b6fffef-1f5d-58a8-963f-e72e2aa75f2b",
        "5b71df6d-3437-4840-b78f-c0258a503ab9",
        "5bfef2a3-ad6b-5cb8-8a41-9d089f15ed41",
        "5c130275-5283-49e9-8932-9dd427e28bf9",
        "5c8c4ce8-bb26-4f80-a6d8-92d1fb6a96e3",
        "5c9a9b3c-71ac-5a7c-9a93-044ecb827979",
        "5ca25b68-6908-432f-89f8-65d448065af9",
        "5dfa50be-f412-411c-a108-f59810c13d25",
        "5e6d343c-740b-41e5-9fd3-4539f5cf2fba",
        "5f025088-5297-5acd-ad6c-cb4d8d33d396",
        "5f8bacf5-a53f-46c1-b6a4-70014ace238d",
        "60dc1168-2f28-474b-bb49-c879484f22b9",
        "617daea1-cb10-4ea5-bfc6-5e81f07acdc2",
        "63fa4d6f-1a71-5dd3-ac38-699817aa6024",
        "64e16ee8-9def-5900-b897-04d86e36a2d4",
        "6549d577-10e1-4231-8742-41eba2332b7a",
        "66586389-a7d1-442c-a3c3-23ca8293e182",
        "6690fa4a-1e58-5d16-bcdc-0acf29890921",
        "68822020-6b21-44a5-b553-c7500036c370",
        "6ab9d39f-6b86-5d8b-b5c5-52822adcf41b",
        "6ad67d47-7721-557a-a8ad-6cda6f96e19d",
        "6b1832d7-c911-4f87-a18e-29e84c54c4e2",
        "6cd5137c-4c27-4175-a5e7-caf448561fd7",
        "6d439597-2b36-4076-9dbc-89d6c334c4fd",
        "6d6a1ef8-ec4e-5798-bfbe-dafe59d80c7b",
        "6ed7c603-2dcb-5714-b11d-7f370a2b0f71",
        "6f5ca523-1e80-5707-bc33-b06085be2141",
        "6f655af6-5c1f-4c44-9e11-e26660098de8",
        "6f9ec576-cd58-5fa9-a4f9-2f727dcda458",
        "710287d6-c3fe-422f-a17f-477d8ee55d45",
        "714d1bbc-362b-4038-8888-15c420313c95",
        "72c17c50-c275-4827-a8ef-fdc672b34b4d",
        "7344986b-3079-4db2-92b9-78e0644c8610",
        "73962280-9abe-4429-b127-a1062b1b3fd5",
        "73e75f59-3cf2-52b1-bbbe-9b3829eb6a5e",
        "744fc361-3646-440a-8380-3fb173af0cd1",
        "74c34e51-1968-4e5d-b1d3-e5df6a9be9fb",
        "7555cb53-1d60-5ddc-9ba1-a28d36f8e6cd",
        "760e6666-7269-5111-b525-79940abd2b08",
        "77395561-1189-4f0c-a5d6-035e5ced5c78",
        "77956d9c-dfe5-4857-8caa-3908375cc323",
        "77b44c56-c161-4234-815b-f90a130c30ec",
        "77d650fb-9d9b-4bb2-8289-adeef4196a5d",
        "787e54d3-7b8b-4cc9-bee3-9e9218e10109",
        "78cb4a09-360d-4155-933c-195a2ae5b262",
        "79447c2d-a842-4328-b91f-2a53b15782d4",
        "79af99c8-09ae-4a4e-bd0b-8f499fbb1e3a",
        "79e708b2-7218-457e-bc23-82ffd95ce5a0",
        "7a356a8f-de27-5eed-86ef-9976fb963b0f",
        "7ae07f02-cf03-5c18-90f0-b11f71a7349b",
        "7b087a5a-dc7a-41e9-ac47-9c3b84f9018b",
        "7b2d0f6a-fdb8-5240-b5a6-1d22dd1d2b51",
        "7d3d1276-696a-4a41-ab53-c12804b57470",
        "7d4ae38e-8a06-4d3f-bbe2-099ce4b9ab33",
        "7dbe66ee-ff70-4081-bd90-160dc92fbd5d",
        "7de30d3c-c004-4b23-b13a-5eb51a65578e",
        "7e96b641-1efe-4920-9b39-2b72c6883215",
        "7e9e06c8-08ec-48a1-9661-8968801596e5",
        "7ef6ccdd-e4a3-540d-9671-512069c36cd9",
        "7fe3844b-7ca8-404e-8c6b-cee322b1387a",
        "801178f4-c3b1-576c-a6d2-1681d7efefde",
        "807d828a-1433-42f6-8f3c-ff255c57da40",
        "80eafc61-ca05-4237-8237-89df2a4d0988",
        "8128cfaf-25f6-5f03-b8d4-0dd36c45b816",
        "821fb96e-219f-49ec-9be7-e0bdf98f9149",
        "8241957b-e824-56ef-8a7d-8fc04f466e95",
        "83b099ae-cc08-4970-bc1d-439a890ba764",
        "83ca6e81-9a76-408a-95f1-243bcbe0a2fc",
        "83ee47ac-e1db-471e-967a-d134a140c6c7",
        "858b9c23-ba2c-4351-b874-d5d5c47b7dc3",
        "85b3d7ab-c0c1-4a7a-9bb3-3ea921e2e2b9",
        "86bb81d1-b630-4611-b168-7962a43b88ca",
        "86c078cc-1adf-5a2e-a6fe-82f37bbbb328",
        "87228d2d-3097-5748-b299-134ef0eb6c1a",
        "87ee41f9-100d-4b9f-8207-7e08b0cf1602",
        "883aec2a-ad69-4a5f-a940-9e60897d10c9",
        "88d1820a-babe-54e4-9371-b803d04fb1aa",
        "89704746-820c-4235-b2a9-5422418a4997",
        "89d0571f-53fd-5407-96f4-738c860d8569",
        "8a4c9cca-4802-5cb6-8f14-6425ad1b0d3f",
        "8b3e4448-1f6a-44fa-8b83-388f8403a0a7",
        "8b9f2770-36a8-497b-a59a-34b2c4eeed99",
        "8be110b0-9c99-52a4-be45-c63745164709",
        "8c09543e-3e02-54f2-ba2e-a6b72733b637",
        "8d7a50d5-4365-4137-9b7e-96ee7c7cf4c0",
        "8db795ba-8896-468d-8e1b-a3cc577d1daf",
        "8dce827b-73c2-4a1e-a800-ca1e9bf61b6b",
        "8e1d1409-2607-5f13-b088-b101a92d4948",
        "8e4c62db-bb77-40b6-b667-11ae1d2f5e3c",
        "8e6e15f8-a69b-4895-8d27-23eeb265a31f",
        "8ebd72e2-0284-5b6b-854b-1557bf3a0aff",
        "8f14db91-e13a-4cbb-8ac2-d53e4093ddbf",
        "8fb8e50c-e65c-4510-be77-0044cb7f5700",
        "902b0d38-c374-493b-84a1-b8f38790d1e6",
        "9032e73b-66a7-4a84-bde0-d4633a52423d",
        "919bd066-7964-4b5b-b352-bdf63ef6f5f8",
        "920725c6-229b-4f50-870b-b87366ce4f9e",
        "937f35ea-75fd-47fb-9123-64e8c4085a39",
        "95497188-90c9-4aff-9446-222d4d6f9743",
        "95ae417b-ca35-5329-bf5c-f52491bd649b",
        "962ddd95-e1d0-41bc-8460-53416914502c",
        "98673ed5-5dfb-4931-a6cd-33a913315668",
        "99082e92-111b-53d2-a448-1b243e73b14e",
        "9a7575da-764a-5b19-8c88-7bdb47fdf65d",
        "9a772436-b150-40c2-8316-8a4ade7a17d8",
        "9bec2f83-257d-5d90-80d0-07bf0e90aeea",
        "9cf3efae-6a04-4ca8-8769-c6204cf71df2",
        "9d8b51d7-af16-4db1-8eb5-7bd9d7b29041",
        "9d93c706-cccd-5418-b5e4-2c9b2b45c160",
        "9ec2d26e-114d-5ea9-8fae-de8a4bbf67a9",
        "9f2370cf-9847-458a-a37d-a5dd24587cfd",
        "9f4a4447-fa4b-4b3e-8904-e24bf1fa673b",
        "a0aa151b-c104-49a6-a0a7-7d2cb965d23d",
        "a15606d4-24e2-5957-b56b-4ff12d462e99",
        "a1e0a218-5c1b-43e6-9bdd-06d693117833",
        "a2bfd362-7d93-4b62-8e66-aea4c1bf4dae",
        "a3297323-f0c4-4efc-aef5-c024df86669a",
        "a356793b-2555-4156-a939-1edfdf939fb1",
        "a4b7184e-4595-4041-b53b-59a1d2a859b5",
        "a4be3828-ebd3-45a6-92f4-bc13a9a848b5",
        "a5dc4eda-c1b5-472c-922d-0b27f5c14d6a",
        "a601f6db-2bcf-4764-adf5-5b22c15336cc",
        "a61932dc-ec17-406a-abd5-96e09ccf47bf",
        "a629e9b8-6e8b-49e2-a5fd-9d33832d5086",
        "a6f70d80-b66b-4a66-84f3-3853ee6e6906",
        "a78a8432-5d68-4476-8fbb-5ae4bfe71d68",
        "a7a05c0d-d22b-51ee-b3a0-0526ea62ccd0",
        "a7a37214-9827-4d48-8e31-7c644b1ba14d",
        "a98d2064-7ddd-44bc-afff-6605466304ea",
        "aa698b7f-e2d4-4298-a534-3c2cca69c51b",
        "ab59febd-03a5-4e33-9c67-072e3ad2d860",
        "abfdc607-79b0-4255-8c26-4b9116fb9e2f",
        "ac664a7f-716c-42ad-b85c-1770c28f4158",
        "ad76a396-8e50-5466-82d1-cbda7c08fd59",
        "ad91991d-4709-5aeb-a283-a21577a21347",
        "ada86e28-8cc2-4cd1-974f-79cc8153b47b",
        "af18b829-cb95-5157-9de0-c76dffaf571c",
        "af7be9fa-4c57-4d99-98c5-611e32962dfb",
        "b0171bce-70c0-47d8-a0e9-ca33dfc6dd98",
        "b0466b28-e9e4-5535-983c-ccce1c458bd5",
        "b0fb24f5-fafa-4370-bf57-1b9e7b8ca321",
        "b0ffd0a2-9c83-4d73-b899-7f2ade2acda6",
        "b1652528-2290-4e3c-9ff8-710dadafd7bc",
        "b187ab4d-299a-4be7-8ee1-cb71b10a54cf",
        "b19892a9-a128-4a8f-8810-0505518daced",
        "b26cc93a-e957-5ae6-aa0b-e480686c1225",
        "b31d1e59-ec8d-452f-bb0a-288af5338a46",
        "b3fea1d2-3f9e-5bd5-a4fd-fea568eca980",
        "b44f90f2-7fe9-5cf5-af8e-c5f6c81ab343",
        "b46d6ab7-8508-51b6-bcc9-d6224154e120",
        "b4de13a8-59d4-418d-bb91-97ff7fed79a1",
        "b5c795f9-ac00-5ca5-9b5c-241f9b18513e",
        "b60b9501-0a69-4f23-ba0e-500b45291db9",
        "b6608df0-8ea2-5510-9d48-b99ef3272e2b",
        "b6c3b106-5a2c-4711-aa01-6bacc62e5621",
        "b974b145-bb96-587b-a881-ee6637b3cb70",
        "b99dbaac-3236-49f4-85f0-746e620ec5e4",
        "b9aac7ef-4e12-5026-afe7-0a1afe559b47",
        "b9cca0fe-e685-4f2f-a485-f62e6735cf58",
        "ba1d2a79-1cd4-5c5f-8e77-507b1e96551d",
        "bad5a177-5bb2-4f0f-b492-f2f5f88ea8f7",
        "bae2756b-a2d9-473e-9d41-fb61c155ecb8",
        "bb69c740-3ff1-4594-be1f-a7e67e7feeba",
        "bba99523-1af8-4cb6-8d42-d85c18b39c88",
        "bbbab282-63fe-5d1b-a1a3-f5b62fd24907",
        "bcda5506-e510-5087-a3af-009681679f80",
        "bd1fab2b-ddde-4e1d-9c5b-39cf47ffb471",
        "be26e24d-420c-5181-b424-215bd969cc4f",
        "be432135-5638-4ffe-903b-d2385f11c542",
        "beab5b21-3260-46fa-9c85-684a9f73184c",
        "bf1c3913-985c-4aec-a926-a409b470c476",
        "bf333b79-5ed2-4631-a418-fc8efebdf529",
        "c00e454d-b6c2-4c78-ad85-ce2e91074590",
        "c1d4f3d3-19c4-54b8-8413-a3a3a0ae2aec",
        "c241ba81-4949-5c90-bf1b-bec9ae77fef0",
        "c2b8ec86-d03a-46d9-9d42-49484a195ed8",
        "c30ca0fb-7125-440a-b4fb-34addf9eef04",
        "c347040a-6680-550f-87d5-23f9a27c68c5",
        "c3b76503-ffaf-43c0-9c02-21b2b3bad53e",
        "c3c22e6d-abd4-4ebf-a134-9cb610d82374",
        "c41d77ed-f009-56bf-a164-04dc38fcfdf8",
        "c46d0324-d852-499d-aaba-67d49da5323b",
        "c47dd6d3-afa5-4546-b430-d0e3c24108d5",
        "c4a34aaa-5c48-4ed3-a41b-1658bd03276c",
        "c4cef576-059d-4369-9494-6484d1d6191c",
        "c4f01950-5c65-4ef9-bd50-26bfffdfa848",
        "c5d4585f-fbd9-4b68-83e2-a7e396dbe5ca",
        "c5f61e18-81df-4e56-a24b-cb3ba4877083",
        "c6b53107-4efb-48a9-8ccf-4db622f029f3",
        "c6d72384-3571-43e0-accd-3f9c738e2691",
        "c6f495b6-fbf1-4b16-85f6-945fa7f9c58c",
        "c90435d9-943a-431c-ade8-fd2a27772a51",
        "ca4d8443-a410-413a-8fa8-62355cb676e4",
        "caf4b958-ac71-44e8-b4d7-27b38f151850",
        "cb161297-4bf4-50a6-bb1e-20d629f273ac",
        "cb4b8fa6-25cd-520b-b9ce-e89512951051",
        "ce493e8c-2791-42ac-a25a-13a31a7972aa",
        "cfb77728-3cc1-54bb-84fb-fa8c1b4193e9",
        "d04f597f-e959-4f4c-b416-4d75e19e076a",
        "d08baf1e-f4cc-4cab-946c-e43051660ef1",
        "d185cc67-d223-535e-b225-60761e4f94cc",
        "d4426d04-6433-5498-a871-553c74e5a58b",
        "d4ad6259-16c3-49d5-8b98-a2ed6fac30cb",
        "d4c2e3b9-8813-5bdb-a63a-261ada2fd488",
        "d6ca08ba-6513-5e6d-9dae-1c780c7a7420",
        "d798654b-7739-54c0-84e3-6d8cfe711f62",
        "d9f7ef17-f6d3-577a-821e-4a6c34deacd5",
        "da826210-6bb2-456a-b65d-1c07003cfb62",
        "daae5893-18f3-4e62-9d77-764436b63ef3",
        "db8565be-8542-460c-86d4-096b505cac5a",
        "db9125a4-153b-532b-862a-a3a0d152e445",
        "db9df9d5-32ec-4cb1-83af-2d6cab03e26f",
        "dc2bef16-08ad-4f45-a730-83e978a744c0",
        "dcb38c0d-6525-4011-8525-98c16665f266",
        "ddaaf259-4556-45b0-8890-86c04aa1afa6",
        "de1aa797-41df-4bcf-80e4-c8d860b1c4e6",
        "debf2b25-c672-40ce-97b5-af72f30eccb2",
        "e071b95f-11ff-49d4-8473-73adb0679093",
        "e073fe63-f963-546c-8edd-762a059689e4",
        "e08716c8-90cb-5188-ad47-80cddfe8baee",
        "e16605aa-4bf0-5bee-ac7a-71c5c1caf8b8",
        "e304dd51-86de-4012-af91-8689a9eb4733",
        "e35c27e5-6a60-5ec0-9d38-9fdcbbbeb185",
        "e3987ae7-b165-5b28-8196-3f26f2b1eddf",
        "e3b74c7d-60d2-4b0c-adea-a6fa4ab36155",
        "e427f8f8-d6bf-4420-b690-bc28cc328cf8",
        "e4c006f1-efe1-437c-aed1-94210be0e07b",
        "e53d224a-f64b-4c10-bb78-a8e34083e6bb",
        "e7a6cab6-af4e-4064-9ab1-4787c431d63d",
        "e9f3a97d-e884-57f0-9cee-c9a7470729e9",
        "ea3c6f8f-0c36-493d-ac88-1c77014e6eaa",
        "ea9d8186-22c7-4102-a0dc-dac63e00dc3a",
        "eba0a9ff-6612-4690-9d55-3eda4dd7019c",
        "ec96bf2b-492f-5022-bc94-d3a7e460876a",
        "ecfc327a-3dc6-5918-aebf-ce17c4ff3a38",
        "ed5a4287-94eb-4889-b028-69e3363eb378",
        "ed8e28e9-12b1-4994-96f0-0bc4aa977a97",
        "f1867755-b71b-41da-985f-abe0a4f77c99",
        "f243c333-b8f4-509a-9a13-92e377aac4ce",
        "f262c0b5-9912-4dfb-8964-9b90251e7dd5",
        "f3626ef7-49ba-4078-b95d-5452b1fad8df",
        "f36ee25d-a7a0-447c-88da-60f7b64137a1",
        "f3b5f7c4-0700-4afd-a4e7-ecf3805dce4c",
        "f3ec0944-ccba-4ac0-b620-f0a426527512",
        "f5acebc7-552b-5014-ae0d-5ce973cb047b",
        "f63c39ec-25ad-5889-a566-8988ca0c604f",
        "f6fd5da2-2602-5cf4-8001-1cf6d78ca806",
        "f78cdc22-37ab-42b8-b0a4-db74a8ae7a3f",
        "f7ba8841-1754-4b4f-b2b3-b732339a2e4e",
        "f7beeb18-e02d-47d0-ab7a-faa79b7f315c",
        "f815ba20-ca55-5324-a460-14697df85f87",
        "f81ba3f6-f368-5706-a0f1-a144e7accfcd",
        "f9e570eb-2ef7-592d-9919-8bdfd51d2efd",
        "fa572504-16f8-48c3-ab25-1da9f602d097",
        "fce5fde3-d84e-48b9-8d64-7366d783137e",
        "fcf44141-6a74-4805-861d-747433bc2063",
        "fd181570-802c-40cf-b217-441a935e2b65",
        "fd24ec74-eeed-5abd-928f-2a4c7ce0b254",
        "fd2aee7c-f35d-5249-b50c-1ef7bf800b01",
        "fd949c21-c297-455d-8046-6c9b4c7e9f46",
        "ffc5c46e-3da2-42be-b747-88b8641a844b"
      ]
    end

    it 'can list all extensions for a given archive version, book id and page uuid' do
      expect(s3.ls archive_version, book_id, page_uuid).to eq [ 'json', 'xhtml' ]
    end
  end

  context '#find_page' do
    it 'can find a page with a given uuid' do
      expect(s3.find_page page_uuid).to eq(
        "#{archive_path}/#{archive_version}/contents/#{book_id}:#{page_uuid}.#{extension}"
      )
    end
  end
end
